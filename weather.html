<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="title">Weather Updates</title>
    <link rel="icon" href="logo.png" type="image/png">

    <script>
        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>

    <link rel="stylesheet" href="style.css" />
</head>

<body>

    <header class="site-header">
        <div class="logo">AgroSetu</div>

        <button class="hamburger" onclick="toggleMenu()">â˜°</button>

        <nav id="navbar">
            <a href="index.html" data-i18n="nav_home">Home</a>
            <a href="weather.html" data-i18n="nav_weather">Weather</a>
            <a href="assistant.html" data-i18n="nav_assistant">AI - Assistant</a>
            <a href="schemes.html" data-i18n="nav_schemes">Govt Schemes</a>
            <a href="languages.html" data-i18n="nav_language">Language</a>
        </nav>
    </header>

    <div style="display:flex; justify-content:flex-end; padding:8px 16px;">
        <button id="themeToggle" style="background:var(--accent); border:none; border-radius:50%; width:40px; height:40px;
        display:flex; align-items:center; justify-content:center; font-size:20px; cursor:pointer;">
            ðŸŒ™
        </button>
    </div>

    <div class="section fade-in">
        <h2 data-i18n="main_title">Current Weather Information</h2>
        <p data-i18n="main_desc">
            Check simple weather forecasts for better farming decisions. Temperature, rainfall, and humidity data are
            displayed clearly.
        </p>

        <div
            style="margin-top:20px; display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:center;">
            <label class="form-label" data-i18n="enter_location">Enter Your Location:</label>
            <input type="text" id="locationInput" class="input-field" placeholder="e.g. Pune" />
            <button class="btn primary" onclick="getWeather()" data-i18n="get_weather">
                Get Weather
            </button>
        </div>

        <div id="errorMessage" style="color:red; text-align:center; margin-top:15px; display:none;"></div>
        <div id="loadingMessage" style="text-align:center; margin-top:15px; display:none;" data-i18n="loading">
            Loading weather data...
        </div>

        <div class="cards" style="margin-top:40px;">
            <div class="card">
                <p data-i18n="temp">Temperature</p>
                <h3 id="temperature" style="color:var(--accent); margin-top:10px;">--Â°C</h3>
            </div>
            <div class="card">
                <p data-i18n="rain">Rainfall</p>
                <h3 id="rainfall" style="color:var(--accent); margin-top:10px;">-- mm</h3>
            </div>
            <div class="card">
                <p data-i18n="humidity">Humidity</p>
                <h3 id="humidity" style="color:var(--accent); margin-top:10px;">--%</h3>
            </div>
        </div>
    </div>

    <footer class="fade-in" style="background:var(--accent); color:white; padding:20px; margin:20px auto;
    max-width:1100px; box-shadow:0 6px 20px var(--shadow);" data-i18n="footer">
        Â© 2025 AgroSetu | Weather Module
    </footer>

    <script>

        let API_KEY = null;

        async function loadApiKey() {
            try {
                const res = await fetch('api_key.txt');
                API_KEY = (await res.text()).trim();
            } catch {
                const err = document.getElementById('errorMessage');
                err.textContent = 'Error loading API configuration.';
                err.style.display = 'block';
            }
        }
        loadApiKey();


        let lastScroll = 0;
        const nav = document.querySelector("nav");

        window.addEventListener("scroll", () => {
            const current = window.scrollY;
            if (current > lastScroll && current > 50) nav.classList.add("nav-small");
            else nav.classList.remove("nav-small");
            lastScroll = current;
        });


        const themeBtn = document.getElementById("themeToggle");
        const mobileNav = document.getElementById("navbar");

        themeBtn.onclick = () => {
            const t = document.body.dataset.theme === "dark" ? "light" : "dark";
            document.body.dataset.theme = t;
            themeBtn.textContent = t === "dark" ? "â˜€ï¸" : "ðŸŒ™";
            localStorage.setItem("theme", t);
        };

        function toggleMenu() {
            mobileNav.classList.toggle("open");
            themeBtn.style.display = mobileNav.classList.contains("open") ? "none" : "block";
        }

        const savedTheme = localStorage.getItem("theme");
        if (savedTheme) {
            document.body.dataset.theme = savedTheme;
            themeBtn.textContent = savedTheme === "dark" ? "â˜€ï¸" : "ðŸŒ™";
        }


        document.getElementById("locationInput").addEventListener("keypress", e => {
            if (e.key === "Enter") getWeather();
        });

        async function getWeather() {
            const loc = locationInput.value.trim();
            const err = errorMessage;
            const load = loadingMessage;

            if (!API_KEY || !loc) {
                err.textContent = "Please enter a valid location.";
                err.style.display = "block";
                return;
            }

            load.style.display = "block";
            err.style.display = "none";

            try {
                const r = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(loc)}&appid=${API_KEY}&units=metric`);
                if (!r.ok) throw new Error("Location not found.");
                const d = await r.json();

                temperature.textContent = `${Math.round(d.main.temp)}Â°C`;
                humidity.textContent = `${d.main.humidity}%`;
                rainfall.textContent = `${d.rain?.['1h'] || 0} mm`;
            } catch (e) {
                err.textContent = e.message;
                err.style.display = "block";
            } finally {
                load.style.display = "none";
            }
        }


        const translations = {
            en: {
                title: "Weather Updates",
                nav_home: "Home",
                nav_crop: "Crop Advisory",
                nav_weather: "Weather",
                nav_irrigation: "Irrigation Tips",
                nav_assistant: "AI - Assistant",
                nav_schemes: "Govt Schemes",
                nav_language: "Language",
                main_title: "Current Weather Information",
                main_desc: "Check simple weather forecasts for better farming decisions. Temperature, rainfall, and humidity data are displayed clearly.",
                enter_location: "Enter Your Location:",
                get_weather: "Get Weather",
                loading: "Loading weather data...",
                temp: "Temperature",
                rain: "Rainfall",
                humidity: "Humidity",
                footer: "Â© 2025 AgroSetu | Weather Module"
            },
            hi: {
                title: "à¤®à¥Œà¤¸à¤® à¤…à¤ªà¤¡à¥‡à¤Ÿ",
                nav_home: "à¤¹à¥‹à¤®",
                nav_crop: "à¤«à¤¸à¤² à¤¸à¤²à¤¾à¤¹",
                nav_weather: "à¤®à¥Œà¤¸à¤®",
                nav_irrigation: "à¤¸à¤¿à¤‚à¤šà¤¾à¤ˆ à¤¸à¥à¤à¤¾à¤µ",
                nav_assistant: "à¤•à¥ƒà¤¤à¥à¤°à¤¿à¤® à¤¬à¥à¤¦à¥à¤§à¤¿à¤®à¤¤à¥à¤¤à¤¾ à¤¸à¤¹à¤¾à¤¯à¥à¤¯à¤•",
                nav_schemes: "à¤¸à¤°à¤•à¤¾à¤°à¥€ à¤¯à¥‹à¤œà¤¨à¤¾à¤à¤",
                nav_language: "à¤­à¤¾à¤·à¤¾",
                main_title: "à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ à¤®à¥Œà¤¸à¤® à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€",
                main_desc: "à¤¬à¥‡à¤¹à¤¤à¤° à¤•à¥ƒà¤·à¤¿ à¤¨à¤¿à¤°à¥à¤£à¤¯à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤®à¥Œà¤¸à¤® à¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚à¥¤",
                enter_location: "à¤¸à¥à¤¥à¤¾à¤¨ à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚:",
                get_weather: "à¤®à¥Œà¤¸à¤® à¤¦à¥‡à¤–à¥‡à¤‚",
                loading: "à¤®à¥Œà¤¸à¤® à¤¡à¥‡à¤Ÿà¤¾ à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ...",
                temp: "à¤¤à¤¾à¤ªà¤®à¤¾à¤¨",
                rain: "à¤µà¤°à¥à¤·à¤¾",
                humidity: "à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾",
                footer: "Â© 2025 à¤à¤—à¥à¤°à¥‹à¤¸à¥‡à¤¤à¥ | à¤®à¥Œà¤¸à¤® à¤®à¥‰à¤¡à¥à¤¯à¥‚à¤²"
            },
            mr: {
                title: "à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤…à¤ªà¤¡à¥‡à¤Ÿ",
                nav_home: "à¤®à¥à¤–à¥à¤¯à¤ªà¥ƒà¤·à¥à¤ ",
                nav_crop: "à¤ªà¥€à¤• à¤¸à¤²à¥à¤²à¤¾",
                nav_weather: "à¤¹à¤µà¤¾à¤®à¤¾à¤¨",
                nav_irrigation: "à¤¸à¤¿à¤‚à¤šà¤¨ à¤Ÿà¤¿à¤ªà¥à¤¸",
                nav_assistant: "à¤•à¥ƒà¤¤à¥à¤°à¤¿à¤® à¤¬à¥à¤¦à¥à¤§à¤¿à¤®à¤¤à¥à¤¤à¤¾ à¤¸à¤¹à¤¾à¤¯à¥à¤¯à¤•",
                nav_schemes: "à¤¶à¤¾à¤¸à¤•à¥€à¤¯ à¤¯à¥‹à¤œà¤¨à¤¾",
                nav_language: "à¤­à¤¾à¤·à¤¾",
                main_title: "à¤¸à¤§à¥à¤¯à¤¾à¤šà¥€ à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤®à¤¾à¤¹à¤¿à¤¤à¥€",
                main_desc: "à¤¶à¥‡à¤¤à¥€à¤¸à¤¾à¤ à¥€ à¤¯à¥‹à¤—à¥à¤¯ à¤¨à¤¿à¤°à¥à¤£à¤¯ à¤˜à¥‡à¤£à¥à¤¯à¤¾à¤¸à¤¾à¤ à¥€ à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤®à¤¾à¤¹à¤¿à¤¤à¥€ à¤®à¤¿à¤³à¤µà¤¾.",
                enter_location: "à¤¸à¥à¤¥à¤¾à¤¨ à¤ªà¥à¤°à¤µà¤¿à¤·à¥à¤Ÿ à¤•à¤°à¤¾:",
                get_weather: "à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤ªà¤¹à¤¾",
                loading: "à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤¡à¥‡à¤Ÿà¤¾ à¤²à¥‹à¤¡ à¤¹à¥‹à¤¤ à¤†à¤¹à¥‡...",
                temp: "à¤¤à¤¾à¤ªà¤®à¤¾à¤¨",
                rain: "à¤ªà¤°à¥à¤œà¤¨à¥à¤¯",
                humidity: "à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾",
                footer: "Â© 2025 à¤…â€à¥…à¤—à¥à¤°à¥‹à¤¸à¥‡à¤¤à¥‚ | à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤µà¤¿à¤­à¤¾à¤—"
            }
        };

        function applyLanguage(lang) {
            document.querySelectorAll("[data-i18n]").forEach(el => {
                const key = el.dataset.i18n;
                if (translations[lang][key]) el.innerText = translations[lang][key];
            });
        }
        applyLanguage(localStorage.getItem("language") || "en");
    </script>

</body>

</html>